const m="gem-wallet";setTimeout(()=>{window.addEventListener("message",E=>{if(E.origin!==window.origin||E.source!==window&&E.data.app===m||!E.data.source||E.data.source!=="GEM_WALLET_MSG_REQUEST")return;const c=E.data.messageId,{data:{app:_,type:o}}=E;if(o==="REQUEST_GET_NETWORK/V3")chrome.runtime.sendMessage({app:_,type:o}).then(()=>{const s=(e,n)=>{const{app:i,type:r,payload:a}=e;if(i===m&&n.id===chrome.runtime.id&&r==="RECEIVE_GET_NETWORK/V3"){const{result:t,error:d}=a;window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,result:t,error:d},window.location.origin),chrome.runtime.onMessage.removeListener(s)}};chrome.runtime.onMessage.addListener(s)});else if(o==="REQUEST_NETWORK")chrome.runtime.sendMessage({app:_,type:o}).then(()=>{const s=(e,n)=>{const{app:i,type:r,payload:a}=e;i===m&&n.id===chrome.runtime.id&&r==="RECEIVE_NETWORK"&&(window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,network:a.network},window.location.origin),chrome.runtime.onMessage.removeListener(s))};chrome.runtime.onMessage.addListener(s)});else if(o==="REQUEST_GET_ADDRESS/V3"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;if(r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_GET_ADDRESS/V3"){const{result:d,error:p}=t;window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,result:d,error:p},window.location.origin),chrome.runtime.onMessage.removeListener(e)}};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_ADDRESS"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_ADDRESS"&&(window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,publicAddress:t.publicAddress},window.location.origin),chrome.runtime.onMessage.removeListener(e))};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_GET_PUBLIC_KEY/V3"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;if(r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_GET_PUBLIC_KEY/V3"){const{result:d,error:p}=t;window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,result:d,error:p},window.location.origin),chrome.runtime.onMessage.removeListener(e)}};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_PUBLIC_KEY"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_PUBLIC_KEY"&&(window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,address:t.address,publicKey:t.publicKey},window.location.origin),chrome.runtime.onMessage.removeListener(e))};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_GET_NFT/V3"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;if(r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_GET_NFT/V3"){const{result:d,error:p}=t;window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,result:d,error:p},window.location.origin),chrome.runtime.onMessage.removeListener(e)}};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_NFT"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_NFT"&&(window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,nfts:t.nfts},window.location.origin),chrome.runtime.onMessage.removeListener(e))};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_SEND_PAYMENT/V3"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;if(r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_SEND_PAYMENT/V3"){const{result:d,error:p}=t;window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,result:d,error:p},window.location.origin),chrome.runtime.onMessage.removeListener(e)}};chrome.runtime.onMessage.addListener(e)})}else if(o==="SEND_PAYMENT"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;if(r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_PAYMENT_HASH"){const{hash:d}=t;window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,hash:d},window.location.origin),chrome.runtime.onMessage.removeListener(e)}};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_SET_TRUSTLINE/V3"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;if(r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_SET_TRUSTLINE/V3"){const{result:d,error:p}=t;window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,result:d,error:p},window.location.origin),chrome.runtime.onMessage.removeListener(e)}};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_MINT_NFT/V3"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;if(r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_MINT_NFT/V3"){const{result:d,error:p}=t;window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,result:d,error:p},window.location.origin),chrome.runtime.onMessage.removeListener(e)}};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_CREATE_NFT_OFFER/V3"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;if(r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_CREATE_NFT_OFFER/V3"){const{result:d,error:p}=t;window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,result:d,error:p},window.location.origin),chrome.runtime.onMessage.removeListener(e)}};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_CANCEL_NFT_OFFER/V3"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;if(r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_CANCEL_NFT_OFFER/V3"){const{result:d,error:p}=t;window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,result:d,error:p},window.location.origin),chrome.runtime.onMessage.removeListener(e)}};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_ACCEPT_NFT_OFFER/V3"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;if(r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_ACCEPT_NFT_OFFER/V3"){const{result:d,error:p}=t;window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,result:d,error:p},window.location.origin),chrome.runtime.onMessage.removeListener(e)}};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_BURN_NFT/V3"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;if(r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_BURN_NFT/V3"){const{result:d,error:p}=t;window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,result:d,error:p},window.location.origin),chrome.runtime.onMessage.removeListener(e)}};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_ADD_TRUSTLINE"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;if(r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_TRUSTLINE_HASH"){const{hash:d}=t;window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,hash:d},window.location.origin),chrome.runtime.onMessage.removeListener(e)}};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_SIGN_MESSAGE/V3"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;if(r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_SIGN_MESSAGE/V3"){const{result:d,error:p}=t;window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,result:d,error:p},window.location.origin),chrome.runtime.onMessage.removeListener(e)}};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_SIGN_MESSAGE"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_SIGN_MESSAGE"&&(window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,signedMessage:t.signedMessage},window.location.origin),chrome.runtime.onMessage.removeListener(e))};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_SET_ACCOUNT/V3"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;if(r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_SET_ACCOUNT/V3"){const{result:d,error:p}=t;window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,result:d,error:p},window.location.origin),chrome.runtime.onMessage.removeListener(e)}};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_SET_REGULAR_KEY/V3"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;if(r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_SET_REGULAR_KEY/V3"){const{result:d,error:p}=t;window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,result:d,error:p},window.location.origin),chrome.runtime.onMessage.removeListener(e)}};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_CREATE_OFFER/V3"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;if(r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_CREATE_OFFER/V3"){const{result:d,error:p}=t;window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,result:d,error:p},window.location.origin),chrome.runtime.onMessage.removeListener(e)}};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_CANCEL_OFFER/V3"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;if(r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_CANCEL_OFFER/V3"){const{result:d,error:p}=t;window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,result:d,error:p},window.location.origin),chrome.runtime.onMessage.removeListener(e)}};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_SUBMIT_TRANSACTION/V3"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;if(r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_SUBMIT_TRANSACTION/V3"){const{result:d,error:p}=t;window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,result:d,error:p},window.location.origin),chrome.runtime.onMessage.removeListener(e)}};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_SUBMIT_BULK_TRANSACTIONS/V3"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;if(r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_SUBMIT_BULK_TRANSACTIONS/V3"){const{result:d,error:p}=t;window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,result:d,error:p},window.location.origin),chrome.runtime.onMessage.removeListener(e)}};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_SIGN_ALICES_RING/V3"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;if(r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_SIGN_ALICES_RING/V3"){const{result:d,error:p}=t;window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,result:d,error:p},window.location.origin),chrome.runtime.onMessage.removeListener(e)}};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_SIGN_TRANSACTION/V3"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;if(r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_SIGN_TRANSACTION/V3"){const{result:d,error:p}=t;window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,result:d,error:p},window.location.origin),chrome.runtime.onMessage.removeListener(e)}};chrome.runtime.onMessage.addListener(e)})}else if(o==="REQUEST_SET_HOOK/V3"){const{data:{payload:s}}=E;chrome.runtime.sendMessage({app:_,type:o,payload:s}).then(()=>{const e=(n,i)=>{const{app:r,type:a,payload:t}=n;if(r===m&&i.id===chrome.runtime.id&&a==="RECEIVE_SET_HOOK/V3"){const{result:d,error:p}=t;window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,result:d,error:p},window.location.origin),chrome.runtime.onMessage.removeListener(e)}};chrome.runtime.onMessage.addListener(e)})}else o==="REQUEST_CONNECTION"?window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,isConnected:!0},window.location.origin):o==="REQUEST_IS_INSTALLED/V3"&&window.postMessage({source:"GEM_WALLET_MSG_RESPONSE",messagedId:c,isInstalled:!0},window.location.origin)},!1),chrome.runtime.onMessage.addListener(E=>{E.app===m&&(!E.source||E.source!=="GEM_WALLET_MSG_REQUEST"||(E.type==="EVENT_NETWORK_CHANGED"?window.postMessage({type:"networkChanged",source:E.source,payload:E.payload},window.location.origin):E.type==="EVENT_WALLET_CHANGED"?window.postMessage({type:"walletChanged",source:E.source,payload:E.payload},window.location.origin):E.type==="EVENT_LOGIN"?window.postMessage({type:"login",source:E.source,payload:E.payload},window.location.origin):E.type==="EVENT_LOGOUT"&&window.postMessage({type:"logout",source:E.source,payload:E.payload},window.location.origin)))})});chrome.runtime.sendMessage({type:"CONTENT_SCRIPT_LOADED"});window.onbeforeunload=()=>{chrome.runtime.sendMessage({type:"CONTENT_SCRIPT_UNLOADED"})};
